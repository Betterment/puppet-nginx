<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" href="css/bass.css" />
</head>
<body>

  <!-- Beginning of Above the Fold -->
  <div id="top">
    <div class="top-wrapper">

      <!-- Top-Left -->
      <div class="top-left">
        <h1>All of the things are done.</h1>
        <p class="big-desc">
          You're all set up for development. Below is a list of the virtual hosts
          configured in nginx. The light next to each server indicates whether or not each local dev HTTP
          server is running.
        </p>

        <!-- Ngnix Server List -->
        <div class="servers">
          <div class="server-wrapper">
            <span class="server-desc">Please wait...</span>
          </div>
        </div> <!-- End of Server List/Wrapper -->
      </div> <!-- End of Top-Left -->

      <!-- Right -->
      <div class="top-right">
        <img src="images/puppet.png" class="puppet" />
      </div>

    </div> <!-- End of Top-Wrapper -->
  </div> <!-- End of Above the Fold -->


  <!-- Beginning of Beneath the Fold -->
  <div class="clear"></div>
  <div class="wrapper">

    <!-- Bottom-Left -->
    <div class="bottom-left-cont">
     <div class="content">

        <p class="bullet-desc">And that's it! Now go build something awesome.</p>

      </div>
    </div> <!-- End of Bottom-Left -->

  </div>
</body>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js" type="text/javascript"></script>
<script type="text/javascript">
  $(document).ready(function() {
    var servers = $('.servers');
    var server_list = ""
    $.get("/status", function(data) {
      // sort the list of hosts
      var hosts = [];
      for (var host in data) {
        hosts.push(host);
      }
      hosts.sort();

      // for each host, generate the html
      var len = hosts.length;
      for(var i=0; i < len; ++i) {
        var host = hosts[i];
        isUp = data[host]['ok'];
        status = data[host]['status']
        server_list += ' \
          <div class="server-wrapper"> \
            <div class="left"> \
              <div class="left"> \
                <a href="http://'+host+'" class="light">'+host+'</a> \
              </div> \
              <div class="left"> \
                <div class="'+ (isUp?'green-circle':'red-circle') +'"></div> \
              </div> \
            </div> \
            <div> \
              <p class="server-desc">'+status+'</p> \
            </div> \
          </div>';
      }
      servers.html(server_list);
    }, 'json');
  })
</script>
</html>
